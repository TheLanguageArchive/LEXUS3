This is a staging version!

Fixed tickets: #229, #892, #1395.